# % or ! are comments 
#simulattion name 
name = BARBIERI-AT-2p1kVpcm

####dipole mtx elements (in C-nm)
zUL = 2

#### Hamiltonian matrix in the TB Basis in (eV): ordering is as follows [INJ,ULL,LLL,RES,DEPOP]
# 2.1 kv/cm at 70 K
# HTB = [0.0902   0         0         0         0         0         0         0         0         0         0    0.0755         0         0         0         0         0         0         0         0         0         0    0.0658         0         0         0         0         0         0         0         0         0         0    0.0632         0         0         0         0         0         0         0         0         0         0    0.0772         0         0         0         0         0         0         0         0         0         0    0.0782         0         0         0         0         0         0         0         0         0         0    0.0806         0         0         0         0         0         0         0         0         0         0    0.0821         0         0         0         0         0         0         0         0         0         0    0.0841         0         0         0         0         0         0         0         0         0         0    0.0873]
# 2.1 kv/cm at 10k
HTB = [0.0901         0         0         0         0         0         0         0         0         0         0         0    0.0771         0         0         0         0         0         0         0         0         0         0         0    0.0657         0         0         0         0         0         0         0         0         0         0         0    0.0631         0         0         0         0         0         0         0         0         0         0         0    0.0754         0         0         0         0         0         0         0         0         0         0         0    0.0781         0         0         0         0         0         0         0         0         0         0         0    0.0806         0         0         0         0         0         0         0         0         0         0         0    0.0821         0         0         0         0         0         0         0         0         0         0         0    0.0841         0         0         0         0         0         0         0         0         0         0         0    0.0872         0         0         0         0         0         0         0         0         0         0         0    0.0948]
# 2.3 kv/cm at 70 K
# HTB = [ 0.0971         0         0         0         0         0         0         0         0         0         0         0    0.0824         0         0         0         0         0         0         0         0         0         0         0    0.0701         0         0         0         0         0         0         0         0         0         0         0    0.0675         0         0         0         0         0         0         0         0         0         0         0    0.0807         0         0         0         0         0         0         0         0         0         0         0    0.0837         0         0         0         0         0         0         0         0         0         0         0    0.0866         0         0         0         0         0         0         0         0         0         0         0    0.0888         0         0         0         0         0         0         0         0         0         0         0    0.0906         0         0         0         0         0         0         0         0         0         0         0    0.0937         0         0         0         0         0         0         0         0         0         0         0    0.0994]


# barbieri 2.1 kv/cm at 70 k
# E_UL = 0.0755
# E_LL = 0.0658

# barbieri 2.1 kv/cm at 10 k
E_UL = 0.0771
E_LL = 0.0657


# barbieri 2.3 kv cm
# E_UL = 0.0824
# E_LL = 0.0701

# scattering rates matrix in linear form
# for NLVL levels Wmtx((i-1)*NLVL+j) gives the outscattering rate from level i to level j, where i,j = 1,2... NLVL
# 2.1 kv/cm original 70 K
# Wmtx = [0    0.0213    0.0006    0.0013    0.0572    0.0503    0.0627    0.0726    0.1084    0.3856 0.0089         0    0.0463    0.0679    0.3129    0.1718    0.1384    0.0833    0.0657    0.0310        0.0006    0.0746         0    0.4375    0.1099    0.1013    0.0218    0.0090    0.0065    0.0026       0.0011    0.0918    0.3578         0    0.1266    0.1169    0.0326    0.0136    0.0102    0.0037       0.0256    0.3861    0.0795    0.1106         0    0.7676    0.1885    0.0921    0.1047    0.0636    0.0244    0.1982    0.0757    0.1081    0.8640         0    0.2659    0.1003    0.1000    0.0531    0.0330    0.1851    0.0152    0.0257    0.2361    0.3052         0    0.3374    0.1694    0.0599    0.0355    0.1124    0.0055    0.0108    0.1100    0.1147    0.4081         0    0.3270    0.0810    0.0605    0.1130    0.0048    0.0086    0.1580    0.1378    0.2414    0.4043         0    0.2439    0.3021    0.0484    0.0018    0.0030    0.1068    0.0861    0.0956    0.1194    0.3134         0]

# 2.1 kv/cm new ULL 70 K
# Wmtx = [ 0    0.0572    0.0006    0.0013    0.0213    0.0503    0.0627    0.0726    0.1084    0.3856    0.0256         0    0.0795    0.1106    0.3861    0.7676    0.1885    0.0921    0.1047    0.0636    0.0006    0.1099         0    0.4375    0.0746    0.1013    0.0218    0.0090    0.0065    0.0026    0.0011    0.1266    0.3578         0    0.0918    0.1169    0.0326    0.0136    0.0102    0.0037    0.0089    0.3129    0.0463    0.0679         0    0.1718    0.1384    0.0833    0.0657    0.0310    0.0244    0.8640    0.0757    0.1081    0.1982         0    0.2659    0.1003    0.1000    0.0531    0.0330    0.2361    0.0152    0.0257    0.1851    0.3052         0    0.3374    0.1694    0.0599    0.0355    0.1100    0.0055    0.0108    0.1124    0.1147    0.4081         0    0.3270    0.0810    0.0605    0.1580    0.0048    0.0086    0.1130    0.1378    0.2414    0.4043         0    0.2439    0.3021    0.1068    0.0018    0.0030    0.0484    0.0861    0.0956    0.1194    0.3134         0]

# 2.1 kv/cm new ULL 10 K
# Wmtx = [0    0.0479    0.0006    0.0009    0.0188    0.0482    0.0575    0.0631    0.0984    0.3577    0.0000    0.0210         0    0.0772    0.1031    0.3840    0.7391    0.1763    0.0841    0.0970    0.0550    0.0048    0.0005    0.1110         0    0.4230    0.0752    0.0958    0.0211    0.0078    0.0055    0.0025    0.0007    0.0006    0.1243    0.3342         0    0.0895    0.1133    0.0309    0.0119    0.0089    0.0030    0.0006    0.0075    0.2990    0.0443    0.0624         0    0.1655    0.1268    0.0752    0.0580    0.0286    0.0013    0.0221    0.8320    0.0682    0.0931    0.1917         0    0.2545    0.0934    0.0945    0.0523    0.0043    0.0274    0.2178    0.0133    0.0226    0.1709    0.3009         0    0.3070    0.1541    0.0534    0.0004    0.0301    0.0994    0.0046    0.0097    0.1032    0.1096    0.3728         0    0.3084    0.0716    0.0001    0.0534    0.1438    0.0046    0.0081    0.1053    0.1350    0.2264    0.3922         0    0.2314    0.0001    0.2801    0.0944    0.0012    0.0025    0.0415    0.0811    0.0873    0.1107    0.2952         0    0.0001        0    0.2003    0.3238    0.5391    0.1077    0.1619    0.0231    0.0038         0    0.0077         0]

# Wmtx = [0    0.0188    0.0006    0.0009    0.0479    0.0482    0.0575    0.0631    0.0984    0.3577    0.0000    0.0075         0    0.0443    0.0624    0.2990    0.1655    0.1268    0.0752    0.0580    0.0286    0.0013    0.0005    0.0752         0    0.4230    0.1110    0.0958    0.0211    0.0078    0.0055    0.0025    0.0007    0.0006    0.0895    0.3342         0    0.1243    0.1133    0.0309    0.0119    0.0089    0.0030    0.0006    0.0210    0.3840    0.0772    0.1031         0    0.7391    0.1763    0.0841    0.0970    0.0550    0.0048    0.0221    0.1917    0.0682    0.0931    0.8320         0    0.2545    0.0934    0.0945    0.0523    0.0043    0.0274    0.1709    0.0133    0.0226    0.2178    0.3009         0    0.3070    0.1541    0.0534    0.0004    0.0301    0.1032    0.0046    0.0097    0.0994    0.1096    0.3728         0    0.3084    0.0716    0.0001    0.0534    0.1053    0.0046    0.0081    0.1438    0.1350    0.2264    0.3922         0    0.2314    0.0001    0.2801    0.0415    0.0012    0.0025    0.0944    0.0811    0.0873    0.1107    0.2952         0    0.0001         0    0.1077    0.3238    0.5391    0.2003    0.1619    0.0231    0.0038         0    0.0077         0]

#Wmtx = [0    0.3840    0.0772    0.0041    0.0052    0.0273    0.1232    0.0692    0.0657    0.1031         0    0.2990         0    0.0443    0.0022    0.0025    0.0124    0.0510    0.0362    0.0351    0.0624         0    0.1110    0.0752         0    0.0455    0.0486    0.0674    0.0571    0.0644    0.1133    0.4230    0.0001    0.0034    0.0019    0.0156         0    0.7391    0.1763    0.0841    0.0970    0.0550    0.0210    0.0048    0.0040    0.0028    0.0189    0.8320         0    0.2545    0.0934    0.0945    0.0523    0.0221    0.0043    0.0172    0.0099    0.0241    0.2178    0.3009         0    0.3070    0.1541    0.0534    0.0274    0.0004    0.0704    0.0369    0.0202    0.0994    0.1096    0.3728         0    0.3084    0.0716    0.0301    0.0001    0.0442    0.0265    0.0277    0.1438    0.1350    0.2264    0.3922         0    0.2314    0.0534    0.0001    0.0729    0.0483    0.0831    0.0944    0.0811    0.0873    0.1107    0.2952         0    0.2801    0.0001    0.1243    0.0895    0.3342    0.0479    0.0482    0.0575    0.0631    0.0984    0.3577         0    0.0000         0         0         0    0.2003    0.1619    0.0231    0.0038         0    0.0077         0         0]

Wmtx = [0    0.2990    0.0443    0.0004    0.0022    0.0025    0.0124    0.0510    0.0362    0.0351    0.0624         0    0.3840         0    0.0772    0.0009    0.0041    0.0052    0.0273    0.1232    0.0692    0.0657    0.1031         0    0.0752    0.1110         0    0.0115    0.0455    0.0486    0.0674    0.0571    0.0644    0.1133    0.4230    0.0001    0.0003    0.0008    0.0032         0    0.2990    0.1655    0.1268    0.0752    0.0580    0.0286    0.0075    0.0013    0.0019    0.0034    0.0156    0.3840         0    0.7391    0.1763    0.0841    0.0970    0.0550    0.0210    0.0048    0.0028    0.0040    0.0189    0.1917    0.8320         0    0.2545    0.0934    0.0945    0.0523    0.0221    0.0043    0.0099    0.0172    0.0241    0.1709    0.2178    0.3009         0    0.3070    0.1541    0.0534    0.0274    0.0004    0.0369    0.0704    0.0202    0.1032    0.0994    0.1096    0.3728         0    0.3084    0.0716    0.0301    0.0001    0.0265    0.0442    0.0277    0.1053    0.1438    0.1350    0.2264    0.3922         0    0.2314    0.0534    0.0001    0.0483    0.0729    0.0831    0.0415    0.0944    0.0811    0.0873    0.1107    0.2952         0    0.2801    0.0001    0.0895    0.1243    0.3342    0.0188    0.0479    0.0482    0.0575    0.0631    0.0984    0.3577         0    0.0000         0         0         0    0.1077    0.2003    0.1619    0.0231    0.0038         0    0.0077         0         0]

# 2.3 kv/cm new ULL 
# Wmtx = [ 0    0.0234    0.0005    0.0007    0.0087    0.0582    0.0809    0.0936    0.1300    0.3512    0.0008    0.0114         0    0.0898    0.1119    0.4673    0.4959    0.1330    0.0448    0.0451    0.0339    0.0081    0.0005    0.1060         0    0.5011    0.0842    0.0572    0.0194    0.0066    0.0050    0.0020    0.0037    0.0004    0.1082    0.3941         0    0.0878    0.0581    0.0201    0.0066    0.0049    0.0023    0.0034    0.0047    0.3825    0.0672    0.0816         0    0.1583    0.0947    0.0403    0.0321    0.0147    0.0039    0.0258    0.5620    0.0438    0.0542    0.1839         0    0.2539    0.0700    0.0736    0.0561    0.0023    0.0306    0.1619    0.0148    0.0189    0.1356    0.3246         0    0.1796    0.1185    0.0570    0.0004    0.0536    0.0406    0.0027    0.0036    0.0339    0.0824    0.2464         0    0.4426    0.1054    0.0005    0.0819    0.0557    0.0027    0.0035    0.0379    0.1048    0.1631    0.5194         0    0.2798    0.0004    0.2563    0.0579    0.0020    0.0023    0.0284    0.1060    0.1083    0.1528    0.3768         0    0.0003    0.0015    0.1823    0.3881    0.5014    0.1171    0.0576    0.0057    0.0043         0    0.0028         0]


NLVLS = 11
INJ = 1 
ULL = 2
LLL = 3
DEPOP = 4
IGNORE= -1

#characteristic time.. seconds per picosecond and length meters per millimeter 
tch = 1E-12 
lch = 1E-3

# pure dephasing times
Tdeph_iu = .01
Tdeph_ul = 2
Tdeph_il = .01

#grid size in x direction
N = 3000

#gain cavity length (mm) 
L = 2.0

# period length (nm)
Lp = 48

# doping density in [cm^-3]
Ncarriers_cm =  4.0e16

#mode overlap factor [dimensionless] -> ignore these (for Olfa)
Gamma = 1

#refractive index
nTHz = 3.6

#cavity loss in 1/cm;  (from optica paper) 
linear_loss = 7

#reflection coeff 
R = 1